<!DOCTYPE HTML>
	<head>
		<meta charset="utf8">
		<style>
			html, body {
			  height: 100%;
			  margin: 1%;
			}
			#blocklyArea {
			  height: 90%;
			  background:black; 
			  text-align: center;
			}
		</style>
	</head>

	<body>
		<script src="blockly_compressed.js"></script>
		<script src="blocks_compressed.js"></script>

		<script src="msg/js/en.js"></script>

		<a id="downloadAnchorElem" style="display:none"></a>

			
		<div id="blocklyArea">
		<div id="blocklyDiv" style="position:static"></div> 
		</div>
		<xml id="toolbox" style="display: none">
			<category name="Pallette">
				<block type="mouse_moveTo"></block>
				<block type="mouse_move"></block>
				<block type="mouse_click"></block>
				<block type="mouse_scroll"></block>
				<block type="mouse_dragTo"></block>
				<block type="mouse_drag"></block>
				<block type="keyboard_typewrite"></block>
				<block type="keyboard_press"></block>
			</category>
		</xml>

		<div style="text-align: center;" >
			<button onclick="getXML()" style="height: 40px; width: 200px">Get XML</button>
		</div>

		<script>

			function getXML(){
				var blocks = Blockly.getMainWorkspace().getAllBlocks(ordered=true);
				console.log(blocks)
				blocks.forEach(function(block){
					console.log(Blockly.Xml.domToPrettyText(Blockly.Xml.blockToDom(block)));
				})
			}

			Blockly.Blocks['mouse_move'] = {
			  init: function() {
				this.jsonInit(
					{
					  "type": "mouse_move",
					  "message0": "Move +x %1   +y %2 over %3 seconds",
					  "args0": [
						{
						  "type": "field_number",
						  "name": "x_pos",
						  "value": 0,
						  "min": 0,
						  "max": 8196
						},
						{
						  "type": "field_number",
						  "name": "y_pos",
						  "value": 0,
						  "min": 0,
						  "max": 8196
						},
						{
						  "type": "field_number",
						  "name": "duration",
						  "value": 0,
						  "min": 0,
						  "max": 8196
						}
					  ],
					  "inputsInline": true,
					  "previousStatement": null,
					  "nextStatement": null,
					  "tooltip": "",
					  "helpUrl": ""
					}
				)
			  }
			};
			Blockly.Blocks['mouse_moveTo'] = {
			  init: function() {
				  this.jsonInit(
					  {
						  "type": "mouse_move",
						  "message0": "Move to x: %1   y: %2 over %3 seconds",
						  "args0": [
						    {
						      "type": "field_number",
						      "name": "x_pos",
						      "value": 0,
						      "min": 0,
						      "max": 8196
						    },
						    {
						      "type": "field_number",
						      "name": "y_pos",
						      "value": 0,
						      "min": 0,
						      "max": 8196
						    },
						    {
						      "type": "field_number",
						      "name": "duration",
						      "value": 0,
						      "min": 0,
						      "max": 8196
						    }
						  ],
						  "inputsInline": true,
						  "previousStatement": null,
						  "nextStatement": null,
						  "tooltip": "",
						  "helpUrl": ""
					}
				  )
			   }
			};
			Blockly.Blocks['mouse_click'] = {
				init: function() {
					this.jsonInit(
						{
						  "type": "mouse_move",
						  "message0": "Click  %1",
						  "args0": [
						    {
						      "type": "field_dropdown",
						      "name": "NAME",
						      "options": [
						        [
						          "left",
						          "leftclick"
						        ],
						        [
						          "right",
						          "rightclick"
						        ],
						        [
						          "centre",
						          "centreclick"
						        ]
						      ]
						    }
						  ],
						  "inputsInline": true,
						  "previousStatement": null,
						  "nextStatement": null,
						  "tooltip": "",
						  "helpUrl": ""
						}
					)
				}
			}
			Blockly.Blocks['mouse_scroll'] = {
				init: function() {
					this.jsonInit(
						{
							"type": "mouse_scroll",
							"message0": "Scroll %1 for  %2 +ve",
							"args0": [
							{
							  "type": "field_dropdown",
							  "name": "NAME",
							  "options": [
								[
								  "up",
								  "up"
								],
								[
								  "down",
								  "down"
								],
								[
								  "",
								  ""
								]
							  ]
							},
							{
							  "type": "field_number",
							  "name": "NAME",
							  "value": 0,
							  "min": 0,
							  "max": 8192
							}
							],
							"inputsInline": true,
							"previousStatement": null,
							"nextStatement": null,
							"tooltip": "",
							"helpUrl": ""
							}
						)
					}
				}
			Blockly.Blocks['mouse_drag'] = {
				init: function() {
					this.jsonInit(
							{
							  "type": "mouse_drag",
							  "message0": "Drag +x %1 +y %2 over %3 seconds",
							  "args0": [
							    {
							      "type": "field_input",
							      "name": "x_pos",
							      "text": "0"
							    },
							    {
							      "type": "field_input",
							      "name": "y_pos",
							      "text": "0"
							    },
							    {
							      "type": "field_input",
							      "name": "duration",
							      "text": "0"
							    }
							  ],
							  "inputsInline": true,
							  "previousStatement": null,
							  "nextStatement": null,
							  "tooltip": "",
							  "helpUrl": ""
							}
						)
					}
				}
			Blockly.Blocks['mouse_dragTo'] = {
				init: function() {
					this.jsonInit(
							{
							"type": "mouse_dragto",
							"message0": "Drag to x: %1 y: %2 over %3 seconds",
							"args0": [
							{
							  "type": "field_input",
							  "name": "x_pos",
							  "text": "0"
							},
							{
							  "type": "field_input",
							  "name": "y_pos",
							  "text": "0"
							},
							{
							  "type": "field_input",
							  "name": "duration",
							  "text": "0"
							}
							],
							"inputsInline": true,
							"previousStatement": null,
							"nextStatement": null,
							"tooltip": "",
							"helpUrl": ""
							}
						)
					}
				}
			Blockly.Blocks['keyboard_typewrite'] = {
				  init: function() {
					this.jsonInit(
						{
						  "type": "keyboard_typewrite",
						  "message0": "Type %1 on keyboard with interval of %2",
						  "args0": [
						    {
						      "type": "field_input",
						      "name": "text",
						      "text": "0"
						    },
						    {
						      "type": "field_input",
						      "name": "interval",
						      "text": "0"
						    }
						  ],
						  "inputsInline": true,
						  "previousStatement": null,
						  "nextStatement": null,
						  "tooltip": "",
						  "helpUrl": ""
						}
					)
				  }
				};
			Blockly.Blocks['keyboard_press'] = {
				  init: function() {
					this.jsonInit(
						{
						  "type": "keyboard_press",
						  "message0": "Press %1",
						  "args0": [
						    {
						      "type": "field_input",
						      "name": "key",
						      "text": ""
						    }
						  ],
						  "inputsInline": true,
						  "previousStatement": null,
						  "nextStatement": null,
						  "tooltip": "",
						  "helpUrl": ""
						}
					)
				  }
				};


			//Responsive Script
			var blocklyArea = document.getElementById('blocklyArea');
			var blocklyDiv = document.getElementById('blocklyDiv');
			var workspace = Blockly.inject(blocklyDiv,
					{toolbox: document.getElementById('toolbox')});
			var onresize = function(e) {
				// Compute the absolute coordinates and dimensions of blocklyArea.
				var element = blocklyArea;
				var x = 0;
				var y = 0;
				do {
					x += element.offsetLeft;
					y += element.offsetTop;
					element = element.offsetParent;
				} while (element);
				// Position blocklyDiv over blocklyArea.
				blocklyDiv.style.left = x + 'px';
				blocklyDiv.style.top = y + 'px';
				blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
				blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
				Blockly.svgResize(workspace);
			};
			window.addEventListener('resize', onresize, false);
			onresize();
			Blockly.svgResize(workspace);


		</script>
	</body>
